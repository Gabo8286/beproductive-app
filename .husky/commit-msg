#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Commit message validation
commit_msg_file=$1
commit_msg=$(cat $commit_msg_file)

# Colors
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m'

# Conventional commit pattern
pattern="^(feat|fix|docs|style|refactor|test|chore|perf|ci|build|revert)(\(.+\))?: .{1,50}"

if echo "$commit_msg" | grep -qE "$pattern"; then
    echo -e "${GREEN}✅ Commit message format valid${NC}"
    exit 0
else
    echo -e "${RED}❌ Invalid commit message format${NC}"
    echo ""
    echo "Expected format: type(scope): description"
    echo ""
    echo "Types: feat, fix, docs, style, refactor, test, chore, perf, ci, build, revert"
    echo ""
    echo "Examples:"
    echo "  feat(tasks): add task priority sorting"
    echo "  fix(auth): resolve login validation issue"
    echo "  docs(api): update task API documentation"
    echo ""
    echo "Your message: $commit_msg"
    exit 1
fi
